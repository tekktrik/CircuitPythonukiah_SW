# SPDX-FileCopyrightText: 2022 Alec Delaney
#
# SPDX-License-Identifier: MIT

on:
  release:
    types: [published]

jobs:
  upload-mpy-zips:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout the current repo
      uses: actions/checkout@v3
      with:
        submodules: true
    - name: Run MPY Action
      uses: tekktrik/build-mpy@main
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}
        cpy-tag: "7.2.0"
        mpy-directory: "microcontroller"
        mpy-manifest-file: "microcontroller/mpy_manifest.txt"
        mpy-manifest-type: "exclude"
        zip-directory: "microcontroller"
        zip-manifest-file: "microcontroller/zip_manifest.txt"
        zip-manifest-type: "exclude"